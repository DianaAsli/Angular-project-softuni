<section class="max-w-7xl mx-auto p-6 bg-white rounded-lg shadow-md mt-8">
  <div class="mt-3">

    <!--TODO: add total Rating -->

    @if(!isLoggedIn){
    <p class="text-gray-500 italic"><a class="text-gray-800 cursor-pointer font-bold underline" routerLink="/login">Log
        in</a> to add a comment.</p>
    }
    @if(isLoggedIn && !isFormVisible){
    <button (click)="toggle()" class="bg-blue-300 text-white px-6 py-2 rounded hover:bg-gray-600 transition">
      Add Comment
    </button>
    }

    <!-- Form -->
    @if(isFormVisible){

    <form class="mt-2" [formGroup]="form" (ngSubmit)="submitComment()">

      <input type="hidden" formControlName="rating">
      <!-- Rating -->
      <div class="flex gap-1 mb-3">
        @for(star of [1,2,3,4,5];track $index){
        <span class="cursor-pointer text-2xl" [class.text-yellow-400]="star <=rating"
          [class.text-gray-400]="star > rating" (click)="setRating(star)">â˜…</span>
        }
      </div>

      @if(ratingInput?.invalid && (ratingInput?.touched || ratingInput?.dirty)){
      <p class="mb-3 text-sm text-red-600">
        @if(ratingInput?.errors?.['emptyRating']){
        Rating is required.
        }
      </p>
      }

      <!-- Text -->
      <textarea formControlName="comment" class="w-full border rounded p-2" placeholder="Write your comment..."
        rows="3"></textarea>

      @if(comment?.invalid && (comment?.touched || comment?.dirty)){
      <p class="mt-1 text-sm text-red-600">
        @if(comment?.errors?.['required']){
        Text is required.
        }
      </p>
      }

      <!-- Button -->
      <div class="mt-3 flex gap-2">
        <button type="submit"
          class="bg-blue-300 text-white px-6 py-2 rounded hover:bg-gray-600 transition">Submit</button>
        <button type="button" class="bg-gray-600 text-white px-6 py-2 rounded hover:bg-blue-300 transition"
          (click)="toggle()">Cancel</button>
      </div>

    </form>

    }

  </div>
</section>
